<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>ArcGIS Maps SDK for JavaScript Tutorials: Display a map using arcgis/map-components</title>
    <link rel="stylesheet" href="https://js.arcgis.com/4.30/esri/themes/light/main.css">
    <link rel="stylesheet" href="//js.arcgis.com/3.17/dijit/themes/claro/claro.css">
    <link rel="stylesheet" href="//js.arcgis.com/3.17/esri/css/esri.css">
    <script src="https://js.arcgis.com/4.30/"></script>
    <script type="module" src="https://js.arcgis.com/map-components/4.30/arcgis-map-components.esm.js"></script>

    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
        }

        #esri-map-container {
            height: 100%;
            width: -webkit-fill-available;
            left: 300px;
            position: absolute;
        }

        #esri-colorinfoslider-container {
            position: absolute;
            z-index: 2;
            bottom: 0;
            left: 0;
            background-color: #FFFCD4;
            color: #6B3B64;
            height: 100%;
            width: 300px;
            border-top-right-radius: 8px;
            overflow-x: hidden;
        }

        #basemapToggle-container {
            z-index: 4;
            position: absolute;
            top: 15px;
            right: 15px;
        }

        #spinner {
            visibility: hidden;
            position: relative;
            z-index: 98;
            left: 90px;
            bottom: 250px;
        }

        .btn {
            background: #3498db;
            background-image: -webkit-linear-gradient(top, #6B3B64, #6B3B64);
            background-image: -moz-linear-gradient(top, #6B3B64, #6B3B64);
            background-image: -ms-linear-gradient(top, #6B3B64, #6B3B64);
            background-image: -o-linear-gradient(top, #6B3B64, #6B3B64);
            background-image: linear-gradient(to bottom, #6B3B64, #6B3B64);
            -webkit-border-radius: 28;
            -moz-border-radius: 28;
            border-radius: 28px;
            font-family: Arial;
            color: #ffffff;
            font-size: 14px;
            padding: 3px 7px 3px 7px;
            text-decoration: none;
        }

        .btn:hover {
            background: #3cb0fd;
            background-image: -webkit-linear-gradient(top, #3cb0fd, #3498db);
            background-image: -moz-linear-gradient(top, #3cb0fd, #3498db);
            background-image: -ms-linear-gradient(top, #3cb0fd, #3498db);
            background-image: -o-linear-gradient(top, #3cb0fd, #3498db);
            background-image: linear-gradient(to bottom, #3cb0fd, #3498db);
            text-decoration: none;
        }

        h2 {
            text-align: center;
        }

        #esri_dijit_RendererSlider_0 {
            background-color: #FFFCD4;
        }
    </style>

    <script defer>
        function testing() {

            function ArcAPI_Code() {
                console.log("bar1");
                const mapView = document.getElementById("arcgis-map-element")
                const allLayerViews = mapView.allLayerViews.items
                const allLayerViewLayers = allLayerViews.map(layerView => layerView.layer)
                // console.log("allLayerViewLayers")
                // console.log(allLayerViewLayers)
                const mapViewMap = mapView.map
                const allLayers = mapViewMap.allLayers.items
                // console.log("allLayers")
                // console.log(allLayers)

                s07g511_mean_5_lyr = allLayers.filter(l => l.title == "S07_G511_03_07_mean")[0];
                console.log("s07g511_mean_5_lyr")
                console.log(s07g511_mean_5_lyr)

                // stops: [ // Point Cloud 1
                //     { value: 0.00, color: "#ff2b18ff", label: "0.0" },
                //     { value: 0.25, color: "#f5c926ff" },
                //     { value: 0.50, color: "#7dfd94ff" },
                //     { value: 0.75, color: "#1cc2fdff" },
                //     { value: 1.00, color: "#5813fcff", label: "1.0" }
                // ]

                // stops: [ // Full Spectrum - Bright
                //     { value: 0.00, color: "#FE230AFF", label: "0.0" },
                //     { value: 0.33, color: "#F2FE1E" },
                //     { value: 0.66, color: "#16FDFF" },
                //     { value: 1.00, color: "#5C09FC", label: "1.0" }
                // ]


                let mean5yrRenderer = {
                    type: "simple",  // autocasts as new SimpleRenderer()
                    symbol: { type: "simple-fill", outline: { color: [0, 0, 0, 0], width: 0 } },  // autocasts as new SimpleFillSymbol()
                    visualVariables: [{
                        type: "color",
                        field: "HSI_mean_5",
                        stops: [
                            { value: 0.00, color: "#ff2b18ff", label: "0.0" },
                            { value: 0.25, color: "#f5c926ff" },
                            { value: 0.50, color: "#7dfd94ff" },
                            { value: 0.75, color: "#1cc2fdff" },
                            { value: 1.00, color: "#5813fcff", label: "1.0" }
                        ]
                    }]
                };

                // s07g511_mean_5_lyr.renderer = mean5yrRenderer;
            }

            require([
                "esri/Map",
                "esri/views/SceneView",
                "esri/layers/FeatureLayer",
                "esri/layers/SceneLayer",

                "esri/symbols/SimpleMarkerSymbol",
                "esri/symbols/SimpleLineSymbol",
                "esri/symbols/WebStyleSymbol",
                "esri/layers/support/LabelClass",

                "esri/geometry/Extent",
                "esri/geometry/Polygon",

                "esri/renderers/SimpleRenderer",
                "esri/renderers/UniqueValueRenderer",
                "esri/renderers/ClassBreaksRenderer",

                "esri/smartMapping/symbology/color",
                "esri/smartMapping/symbology/support/colorRamps"
            ], function (Map, SceneView, FeatureLayer, SceneLayer,
                SimpleMarkerSymbol, SimpleLineSymbol, WebStyleSymbol, LabelClass,
                Extent, Polygon,
                SimpleRenderer, UniqueValueRenderer, ClassBreaksRenderer,
                colorSchemes, colorRamps) {
                // Point Cloud 1
                // Green 4
                // Esri Purple 1

                ArcAPI_Code();

                console.log("bar2");
                const mapView = document.getElementById("arcgis-map-element")
                const allLayerViews = mapView.allLayerViews.items
                const allLayerViewLayers = allLayerViews.map(layerView => layerView.layer)
                // console.log("allLayerViewLayers")
                // console.log(allLayerViewLayers)
                const mapViewMap = mapView.map
                const allLayers = mapViewMap.allLayers.items
                // console.log("allLayers")
                // console.log(allLayers)

                s07g511_mean_5_lyr = allLayers.filter(l => l.title == "S07_G511_03_07_mean")[0];
                console.log("s07g511_mean_5_lyr")
                console.log(s07g511_mean_5_lyr)

                let mean5yrRenderer = {
                    type: "simple",  // autocasts as new SimpleRenderer()
                    symbol: { type: "simple-fill", outline: { color: [0, 0, 0, 0], width: 0 } },  // autocasts as new SimpleFillSymbol()
                    visualVariables: [{
                        type: "color",
                        field: "HSI_mean_5",
                        stops: [ // Full Spectrum - Bright
                            { value: 0.00, color: "#FE230AFF", label: "0.0" },
                            { value: 0.33, color: "#F2FE1E" },
                            { value: 0.66, color: "#16FDFF" },
                            { value: 1.00, color: "#5C09FC", label: "1.0" }
                        ]
                    }]
                };

                s07g511_mean_5_lyr.renderer = mean5yrRenderer;

                function ArcAPI_Code_Inside() {
                    console.log("bar3");
                    const mapView = document.getElementById("arcgis-map-element")
                    const allLayerViews = mapView.allLayerViews.items
                    const allLayerViewLayers = allLayerViews.map(layerView => layerView.layer)
                    // console.log("allLayerViewLayers")
                    // console.log(allLayerViewLayers)
                    const mapViewMap = mapView.map
                    const allLayers = mapViewMap.allLayers.items
                    // console.log("allLayers")
                    // console.log(allLayers)

                    s07g511_mean_5_lyr = allLayers.filter(l => l.title == "S07_G511_03_07_mean")[0];
                    console.log("s07g511_mean_5_lyr")
                    console.log(s07g511_mean_5_lyr)

                    let mean5yrRenderer = {
                        type: "simple",  // autocasts as new SimpleRenderer()
                        symbol: { type: "simple-fill", outline: { color: [0, 0, 0, 0], width: 0 } },  // autocasts as new SimpleFillSymbol()
                        visualVariables: [{
                            type: "color",
                            field: "HSI_mean_5",
                            stops: [
                                { value: 0.00, color: "#ff2b18ff", label: "0.0" },
                                { value: 0.25, color: "#f5c926ff" },
                                { value: 0.50, color: "#7dfd94ff" },
                                { value: 0.75, color: "#1cc2fdff" },
                                { value: 1.00, color: "#5813fcff", label: "1.0" }
                            ]
                        }]
                    };

                    // s07g511_mean_5_lyr.renderer = mean5yrRenderer;
                }

                ArcAPI_Code_Inside();
            });
        }
    </script>
</head>

<body class="claro">
    <div id="esri-map-container">
        <arcgis-map id="arcgis-map-element" item-id="567dca963a894ba3acf457ec3915800c">

            <arcgis-legend position="bottom-left" />

            <arcgis-layer-list position="bottom-right" />

        </arcgis-map>
    </div>
    <div id="basemapToggle-container"></div>
    <div id="esri-colorinfoslider-container">
        <div style="padding: 8px;">
            <div id="title">
                <h2>Seattle Demographics</h2>
            </div>
            <button class="btn" id="test-button" onclick="testing();">
                Test
            </button><br><br>
            <div id="attSelection">
                Attribute:
                <select id="select-field">
                    <option value="POP18UP_CY" selected>Population 18+</option>
                    <option value="HH_Income_0_35K">Household income 0-$35K</option>
                    <option value="HH_Income_35_75K">Household income $35K - $75K</option>
                    <option value="HH_Income_75_200K">Household income $75K - $200K</option>
                    <option value="HINC200_CY">Household income >$200K</option>
                    <option value="COL_DEG">Pop 25+ earned a college degree</option>
                    <option value="NO_COL_DEG">Pop 25+ with no college degree</option>
                    <option value="HomeValue_0_150K">Homes worth 0-$150K</option>
                    <option value="HomeValue_150_300K">Homes worth $150K - $300K</option>
                    <option value="HomeValue_300K_up">Homes worth >$300K</option>
                    <option value="MALES_CY">Male</option>
                    <option value="FEMALES_CY">Female</option>
                </select><br><br>

                Filter by:
                <select id="select-filter">
                    <option value="" selected></option>
                    <option value="(MEDHINC_CY >= 50000 AND MEDHINC_CY <= 100000)">Median HH income $50K - $100K
                    </option>
                </select><br><br>

                <button class="btn" id="extent-filter">Filter by map extent</button><button class="btn"
                    id="clear-extent-filter">Clear extent filter</button><br><br>

                Theme:
                <select id="color-renderer-theme" style="margin-right:1rem;">
                    <option value="high-to-low" selected>High to low</option>
                    <option value="above-and-below">Above and below</option>
                    <option value="centered-on">Centered on</option>
                    <option value="extremes">Extremes</option>
                </select>
            </div>
        </div>
        <div id="esri-colorinfoslider"><img src="img/busy-indicator.gif" id="spinner"></div>
    </div>
</body>

</html>